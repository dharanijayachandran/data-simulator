<div *ngIf="showLoaderImage" class="col-lg-12" style="margin-left:0%; margin-top:0%;margin-bottom:0%;"
        align="center">
        <img src="/assets/img/dashboard/ProgressLoader.gif" height="auto" width="50%" alt="Loading........">
      </div>
<div class="row margin_0px">
    <div class="col-md-12 padding_0px">
    <div class="padding_Form">
      
            <form [formGroup]="continuousDataForm">
                <div class="m-form__group row">
                    <div class="col-lg-6">
                        <label i18n="Gateway Template|Gateway Template@@gatewayTemplate*">Gateway Template<span
                                class="text-danger">*</span> </label>
                        <div class="form-group">
                            <div [ngClass]="{'has-error': ((continuousDataForm.get('gateWayTemplateId').touched ||
                            continuousDataForm.get('gateWayTemplateId').dirty) &&
                            continuousDataForm.get('gateWayTemplateId').errors)}">
                            <ejs-dropdownlist id='ddlelement' #ddlelement class="form-control p-0" [value]='gateWayTemplateId'
                  name="gateWayTemplateId" formControlName="gateWayTemplateId" [dataSource]='gatewayTemplateList'
                  [placeholder]='gatewayTemplateWaterMark' [fields]='gatewayTemplateFields' [popupHeight]='height'
                  [sortOrder]="sortDropDown" (filtering)='onFilteringGatewayTemplates($event)'
                  [filterBarPlaceholder]="filterPlaceholder" [allowFiltering]='true'
                  (change)='gateWayTemplateChange($event.itemData.id)' [locale]='locale'></ejs-dropdownlist>
                           
                                <span class="help-block" *ngIf="((continuousDataForm.get('gateWayTemplateId').touched ||
                                continuousDataForm.get('gateWayTemplateId').dirty) &&
                                continuousDataForm.get('gateWayTemplateId').errors)">
                                    <span i18n="Message|Please select GateWay Template@@gatewayTemplate.message"
                                        *ngIf="continuousDataForm.get('gateWayTemplateId').errors.required">
                                        Please select GateWay Template
                                    </span>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <label i18n="Gateway|Gateway @@gateway*">Gateway
                            <span class="text-danger">*</span> (Max no of Gateways allowed to select-{{gatewayLimit}})
                        </label>
                        <div class="form-group">
                            <div>
                                <angular2-multiselect [data]="gateWayForMultiSelect" [settings]="settings"
                                    (onSelect)="OnselectedGateWayItems($event)"
                                    (onDeSelect)="OnItemDeSelectGateWay($event)"
                                    (onSelectAll)="onSelectAllGateWay($event)"
                                    (onDeSelectAll)="onDeSelectAllGateWay($event)" formControlName="gateWayIds">

                                </angular2-multiselect>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="m-form__group row">
                    <div class="col-lg-6">
                        <label i18n="Start Date/Time|Start Date/Time@@startDate/Time*">Start Date/Time<span
                            class="text-danger">*</span></label>
                        <div class="form-group">
                          <div [ngClass]="{'has-error': ((continuousDataForm.get('startDate').touched ||
                          continuousDataForm.get('startDate').dirty) &&
                          continuousDataForm.get('startDate').errors)}">
                            <div class="input-group">
                              <input (click)="d2.toggle()" class="form-control" placeholder="MM/DD/YYYY"
                                formControlName="startDate" placement="bottom-right" ngbDatepicker #d2="ngbDatepicker"
                                [maxDate]="endDate" (dateSelect)="addMinDateValue()" [markDisabled]="isDisabled"
                                (keyup)="validateFromDate()" (ngModelChange)="changeStartDate($event)">
                              <div>
                                <input type="time" id="startTime" i18n-placeholder="" placeholder="" formControlName="startTime"
                                  (click)="validateStartAndEndTime($event.target.id)" (keyup)="validateStartAndEndTime($event.target.id)"
                                  (change)="validateStartAndEndTime($event.target.id)" class="form-control m-input" />
                        
                              </div>
                            </div>
                            <span class="help-block" *ngIf="!continuousDataForm.get('startDate').valid">
                              <span i18n="Message|Please enter valid Start Date@@startDate.message">Please enter valid Start
                                Date</span>
                            </span>
                            <span class="help-block" *ngIf="validateTime">
                              <span style="text-align: right;"
                                i18n="Message|Please enter valid Start Time@@startDate.message1">Start Date/Time should be less than End Date/Time</span>
                            </span>
                          </div>
                        </div>
                      </div>
                      <div class="col-lg-6">
                        <label i18n="End Date/Time|End Date/Time@@endDate/Time*">End Date/Time<span
                            class="text-danger">*</span></label>
                        <div class="form-group">
                          <div [ngClass]="{'has-error': ((continuousDataForm.get('endDate').touched ||
                          continuousDataForm.get('endDate').dirty) &&
                          continuousDataForm.get('endDate').errors)}">
                            <div class="input-group">
                              <input  (click)="d1.toggle()" class="form-control" placeholder="MM/DD/YYYY"
                              formControlName="endDate" placement="bottom-right" ngbDatepicker
                              #d1="ngbDatepicker" [minDate]="minDate" [markDisabled]="isDisabled" (dateSelect)="validateFromStartFromEndDate()" 
                                (ngModelChange)="changeEndDate($event)">
                              <div>
                                <input type="time" id="endTime" i18n-placeholder="" placeholder="HH:mm" formControlName="endTime"
                                  (click)="validateStartAndEndTime($event.target.id)" (keyup)="validateStartAndEndTime($event.target.id)"
                                  (change)="validateStartAndEndTime($event.target.id)" class="form-control m-input" />
                            
                              </div>
                            </div>
                            <span class="help-block" *ngIf="!continuousDataForm.get('endDate').valid">
                              <span i18n="Message|Please enter valid End Date@@endDate.message">Please enter valid End Date</span>
                            </span>
                            <span class="help-block" *ngIf="validateEndTime">
                              <span style="text-align: right;" i18n="Message|Please enter valid End Time@@endDate.message1">  
                                End Date/Time should be greater than Start Date/Time
                                </span>
                            </span>
                          </div>
                        </div>
                      </div>
                  </div>
                <div class="m-form__group row">
                    <div class="col-lg-6">
                        <label
                            i18n="Communication Protocol|Communication Protocol@@communicationProtocol*">Communication
                            Protocol<span class="text-danger">*</span> </label>
                        <div class="form-group">
                            <div [ngClass]="{'has-error': ((continuousDataForm.get('commProtocolId').touched ||
                            continuousDataForm.get('commProtocolId').dirty) &&
                            continuousDataForm.get('commProtocolId').errors)}">
                                <select formControlName="commProtocolId"
                                    (change)="communctionProtocolChange($event.target.value)"
                                    class="form-control m-input" required>
                                    <option i18n="Option|Select@@select" [ngValue]="null">--Select--</option>
                                    <option *ngFor="let gatewayCommProtocol of gatewayComm"
                                        [value]="gatewayCommProtocol.id">
                                        {{gatewayCommProtocol.commProtocol.name}}
                                    </option>
                                </select>
                                <span class="help-block" *ngIf="((continuousDataForm.get('commProtocolId').touched ||
                                continuousDataForm.get('commProtocolId').dirty) &&
                                continuousDataForm.get('commProtocolId').errors)">
                                    <span
                                        i18n="Message|Please Select Communication Protocol@@communicationProtocol.message"
                                        *ngIf="continuousDataForm.get('commProtocolId').errors.required">
                                        Please Select Communication Protocol
                                    </span>
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <label i18n="Data Handler|Data Handler@@data Handler*">Data Handler<span class="text-danger">*</span> (Max no of Data Handlers allowed to select-{{dataHandlerLimit}})
                        </label>
                        <div class="form-group">
                            <div>
                                <angular2-multiselect [data]="dataHandlersForMultiSelect|orderByAlphabetical:'itemName'" [settings]="dataHandlerSettings"
                                    (onSelect)="OnselectedDataHandlers($event)"
                                    (onDeSelect)="OnItemDeSelectDataHandler($event)"
                                    (onSelectAll)="onSelectAllDataHandlers($event)"
                                    (onDeSelectAll)="onDeSelectAllDataHandlers($event)" formControlName="dataHandlers">

                                </angular2-multiselect>
                            </div>
                        </div>
                    </div>

                </div>

                <div *ngIf="isSelected">

                    <div formArrayName="dhTags">
                        <div class="form-group m-form__group row">
                            <div class="col-lg-6"
                                *ngFor="let dsInputParam of continuousDataForm.get('dhTags')['controls']; let i=index;">
                                <ng-container [formGroupName]="i">


                                    <label
                                        class=" m-input-icon m-input-icon--right">{{dataHandlerTagsList[i].nodeIoTag.name}}<span
                                            class="text-danger">*</span></label>
                                    <div
                                        *ngIf="dataHandlerTagsList[i].nodeIoTag.tagType == 'A' && dataHandlerTagsList[i].dataTypeName != 'String' ">
                                        <div class="form-group row">
                                            <div class="col">
                                                <input type="hidden" formControlName="nodeIoTagId"
                                                    [ngModel]="dataHandlerTagsList[i].nodeIoTag.id">
                                                <div [ngClass]="{'has-error': ((dsInputParam.get('value').touched ||
                                                            dsInputParam.get('value').dirty) &&
                                                             dsInputParam.get('value').errors)}">
                                                    <input type="text" formControlName="value" class="form-control"
                                                        id="data" placeholder="Min" />
                                                    <span class="help-block" *ngIf=" ((dsInputParam.get('value').touched ||
                                                           dsInputParam.get('value').dirty) &&
                                                               dsInputParam.get('value').errors)">

                                                        <span
                                                            i18n="Message|  Please enter only Numeric value@@onlyNumericvalue.message"
                                                            *ngIf="continuousDataForm.get('dhTags')['controls'][i].get('value').errors.pattern && (dataHandlerTagsList[i].dataTypeName == 'Integer' || dataHandlerTagsList[i].dataTypeName == 'Long')">
                                                            Please enter only Numeric value
                                                        </span>
                                                        <span
                                                            i18n="Message| Please enter only Alphabate value@@onlyAlphabatevalue.message"
                                                            *ngIf=" continuousDataForm.get('dhTags')['controls'][i].get('value').errors.pattern&& dataHandlerTagsList[i].dataTypeName == 'String'">
                                                            Please enter only Alphabate value
                                                        </span>
                                                        <span
                                                            i18n="Message| Please enter only Decimal value@@onlyDecimalvalue.message"
                                                            *ngIf="continuousDataForm.get('dhTags')['controls'][i].get('value').errors.pattern && (dataHandlerTagsList[i].dataTypeName == 'Double' || dataHandlerTagsList[i].dataTypeName == 'Float')">
                                                            Please enter only Decimal value
                                                        </span>

                                                    </span>

                                                </div>
                                            </div>
                                            <div class="col">
                                                <input type="hidden" formControlName="nodeIoTagId"
                                                    [ngModel]="dataHandlerTagsList[i].nodeIoTag.id">
                                                <div [ngClass]="{'has-error': ((dsInputParam.get('maxvalue').touched ||
                                                            dsInputParam.get('maxvalue').dirty) &&
                                                             dsInputParam.get('maxvalue').errors)}">
                                                    <input type="text" formControlName="maxvalue" class="form-control"
                                                        id="data2" placeholder="Max" />

                                                    <span class="help-block" *ngIf=" ((dsInputParam.get('maxvalue').touched ||
                                                          dsInputParam.get('maxvalue').dirty) &&
                                                          dsInputParam.get('maxvalue').errors)">

                                                        <span
                                                            i18n="Message|Please enter only Alphabate value@@onlyAlphabatevalue.message"
                                                            *ngIf="continuousDataForm.get('dhTags')['controls'][i].get('maxvalue').errors.pattern && continuousDataForm.get('dhTags')['controls'][i].get('value').errors.pattern&& dataHandlerTagsList[i].dataTypeName == 'String'">
                                                            Please enter only Alphabate value
                                                        </span>

                                                        <span
                                                            i18n="Message|Please enter only Numeric value@@onlyNumericvalue.message"
                                                            *ngIf="continuousDataForm.get('dhTags')['controls'][i].get('maxvalue').errors.pattern && (dataHandlerTagsList[i].dataTypeName == 'Integer' || dataHandlerTagsList[i].dataTypeName == 'Long')">
                                                            Please enter only Numeric value
                                                        </span>

                                                        <span
                                                            i18n="Message| Please enter only Decimal value@@onlyDecimalvalue.message"
                                                            *ngIf="continuousDataForm.get('dhTags')['controls'][i].get('maxvalue').errors.pattern && (dataHandlerTagsList[i].dataTypeName == 'Double' || dataHandlerTagsList[i].dataTypeName == 'Float')">
                                                            Please enter only Decimal value
                                                        </span>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                    <div
                                        *ngIf="dataHandlerTagsList[i].nodeIoTag.tagType == 'A' && dataHandlerTagsList[i].dataTypeName == 'String' ">
                                        <div class="form-group row">
                                            <div class="col">

                                                <input type="hidden" formControlName="nodeIoTagId"
                                                    [ngModel]="dataHandlerTagsList[i].nodeIoTag.id">
                                                <div [ngClass]="{'has-error': ((dsInputParam.get('desvalue').touched ||
                                                        dsInputParam.get('desvalue').dirty) &&
                                                         dsInputParam.get('desvalue').errors)}">
                                                    <input type="text" formControlName="desvalue" class="form-control"
                                                        id="data"
                                                        placeholder="{{dataHandlerTagsList[i].nodeIoTag.name}}" />
                                                    <span class="help-block" *ngIf=" ((dsInputParam.get('desvalue').touched ||
                                                       dsInputParam.get('desvalue').dirty) &&
                                                           dsInputParam.get('desvalue').errors)">

                                                        <span
                                                            i18n="Message| Please enter only Numeric value@@onlyNumericvalue.message"
                                                            *ngIf="continuousDataForm.get('dhTags')['controls'][i].get('desvalue').errors.pattern && (dataHandlerTagsList[i].dataTypeName == 'Integer' || dataHandlerTagsList[i].dataTypeName == 'Long')">
                                                            Please enter only Numeric value
                                                        </span>
                                                        <span
                                                            i18n="Message| Please enter only Alphabate value@@onlyAlphabatevalue.message"
                                                            *ngIf="continuousDataForm.get('dhTags')['controls'][i].get('desvalue').errors.pattern&& dataHandlerTagsList[i].dataTypeName == 'String'">
                                                            Please enter only Alphabate value
                                                        </span>
                                                        <span
                                                            i18n="Message| Please enter only Decimal value@@onlyDecimalvalue.message"
                                                            *ngIf="continuousDataForm.get('dhTags')['controls'][i].get('desvalue').errors.pattern && (dataHandlerTagsList[i].dataTypeName == 'Double' || dataHandlerTagsList[i].dataTypeName == 'Float')">
                                                            Please enter only Decimal value
                                                        </span>

                                                    </span>

                                                </div>





                                            </div>

                                        </div>

                                    </div>

                                    <div *ngIf="dataHandlerTagsList[i].nodeIoTag.tagType == 'D'  ">
                                        <div class="form-group">
                                            <div></div>

                                            <input type="hidden" formControlName="nodeIoTagId"
                                                [ngModel]="dataHandlerTagsList[i].nodeIoTag.id">
                                            <div [ngClass]="{'has-error': ((dsInputParam.get('desvalue').touched ||
                                                            dsInputParam.get('desvalue').dirty) &&
                                                             dsInputParam.get('desvalue').errors)}">
                                                <input type="text" formControlName="desvalue" class="form-control"
                                                    id="data" placeholder="Possible values seperated by ," />
                                                <span class="help-block" *ngIf=" ((dsInputParam.get('desvalue').touched ||
                                                           dsInputParam.get('desvalue').dirty) &&
                                                               dsInputParam.get('desvalue').errors)">

                                                    <span
                                                        i18n="Message| Please enter only Numeric value@@onlyNumericvalue.message"
                                                        *ngIf="continuousDataForm.get('dhTags')['controls'][i].get('desvalue').errors.pattern && (dataHandlerTagsList[i].dataTypeName == 'Integer' || dataHandlerTagsList[i].dataTypeName == 'Long')">
                                                        Please enter only Numeric value
                                                    </span>
                                                    <span
                                                        i18n="Message| Please enter only Alphabate value@@onlyAlphabatevalue.message"
                                                        *ngIf="continuousDataForm.get('dhTags')['controls'][i].get('desvalue').errors.pattern&& dataHandlerTagsList[i].dataTypeName == 'String'">
                                                        Please enter only Alphabate value
                                                    </span>
                                                    <span
                                                        i18n="Message| Please enter only Decimal value@@onlyDecimalvalue.message"
                                                        *ngIf="continuousDataForm.get('dhTags')['controls'][i].get('desvalue').errors.pattern && (dataHandlerTagsList[i].dataTypeName == 'Double' || dataHandlerTagsList[i].dataTypeName == 'Float')">
                                                        Please enter only Decimal value
                                                    </span>

                                                </span>

                                            </div>

                                        </div>
                                    </div>



                                </ng-container>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="path finalLine"></div>
                <div class="row" style="    text-align: right;padding: 23px 0;">
                    <div class="col-md-12">
                        <button type="button" class="btn btn-secondary text-center resetActionButton"
                            [disabled]="(!continuousDataForm.dirty && continuousDataForm.pristine)"
                            i18n="Reset button|Reset@@reset" (click)="resetForm()">
                            Reset
                        </button>
                        &nbsp;
                        <span i18n-matTooltip="Tooltip validation|Fill the mandatory fields@@fillTheMandatoryFields"
                            matTooltip="Fill the mandatory fields" [matTooltipDisabled]='(continuousDataForm.valid && !disableButton)'>
                            <button i18n="Send button|Send@@send" class="btn btn-primary text-center"
                                (click)="sendForm()" type="submit" [disabled]="!continuousDataForm.valid || disableButton">
                                Send</button>
                        </span>
                    </div>
                </div>

            </form>
        </div>
    </div>


<!-- Global modal notification component selector for cancel and final save form-->
<app-modal-notification></app-modal-notification>